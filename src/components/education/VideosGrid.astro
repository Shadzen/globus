---
import playIcon from '@/assets/icons/play-accent.svg'

export interface VideoItem {
    id: string
    videoUrl: string
    thumbnailUrl?: string
    date: string
    title: string
    materials?: Array<{
        label: string
        url: string
    }>
}

interface Props {
    videos: VideoItem[]
    userType?: 'tourist' | 'agent'
}

const { videos } = Astro.props
---

<div class="videos-grid">
    {
        videos.map((video) => (
            <div class="video-card">
                <a
                    href={video.videoUrl}
                    class="video-thumbnail"
                    target="_blank"
                    rel="noopener noreferrer"
                >
                    {video.thumbnailUrl ?
                        <img src={video.thumbnailUrl} alt={video.title} loading="lazy" />
                    :   <div class="video-thumbnail-placeholder" />}
                    <div class="video-play-icon">
                        <img src={playIcon.src} alt="Play" />
                    </div>
                </a>

                <div class="video-info">
                    <time class="video-date">{video.date}</time>
                    <h3 class="video-title">{video.title}</h3>

                    {video.materials && video.materials.length > 0 && (
                        <div class="video-materials">
                            {video.materials.map((material) =>
                                material.url ?
                                    <a
                                        href={material.url}
                                        class="video-material-link"
                                        target="_blank"
                                        rel="noopener noreferrer"
                                    >
                                        {material.label}
                                    </a>
                                :   <p class="video-material-text">{material.label}</p>,
                            )}
                        </div>
                    )}
                </div>
            </div>
        ))
    }
</div>

<style lang="scss" is:global>
    .videos-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        @include adaptive(column-gap, 18, 20);
        @include adaptive(row-gap, 60, 60);

        @include mobile {
            grid-template-columns: 1fr;
        }

        .video-card {
            display: flex;
            flex-direction: column;
            @include adaptive(gap, 20, 15);
        }

        .video-thumbnail {
            position: relative;
            @include adaptive(height, 198, 254);
            width: 100%;
            overflow: hidden;
            display: block;
            cursor: pointer;
            transition: opacity 0.3s;

            &:hover {
                opacity: 0.9;

                .video-play-icon {
                    transform: translate(-50%, -50%) scale(1.1);
                }
            }

            img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                display: block;
            }
        }

        .video-thumbnail-placeholder {
            width: 100%;
            height: 100%;
            background-color: #d9d9d9;
        }

        .video-play-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            @include adaptive(width, 62, 50);
            @include adaptive(height, 62, 50);
            transition: transform 0.3s;

            img {
                width: 100%;
                height: 100%;
                object-fit: contain;
            }
        }

        .video-info {
            display: flex;
            flex-direction: column;
            @include adaptive(gap, 8, 8);
        }

        .video-date {
            @include font-circe-regular;
            @include adaptive(font-size, 16, 18);
            color: #667c89;
            line-height: 1.6;
            text-transform: uppercase;
            @include adaptive(letter-spacing, 3.2, 3.2);
        }

        .video-title {
            @include font-circe-regular;
            @include adaptive(font-size, 20, 24);
            color: $color-accent;
            line-height: 1.2;
            text-transform: uppercase;
            margin: 0;
            font-weight: 400;
            white-space: normal;
            width: 90%;
        }

        .video-materials {
            display: flex;
            flex-direction: column;
            @include adaptive(gap, 5, 5);
            @include adaptive(margin-top, 6, 5);
        }

        .video-material-link {
            @include font-circe-regular;
            @include adaptive(font-size, 18, 18);
            color: $color-main;
            line-height: 1.2;
            text-decoration: none;
            transition: opacity 0.3s;
            white-space: normal;

            &:hover {
                opacity: 0.7;
            }
        }

        .video-material-text {
            @include font-circe-regular;
            @include adaptive(font-size, 18, 18);
            color: $color-main;
            line-height: 1.2;
            margin: 0;
            white-space: normal;
        }
    }
</style>
