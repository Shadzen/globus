---
// src/components/main/ContactForm.astro
import phoneIcon from '@/assets/icons/phone-accent.svg'
import mailIcon from '@/assets/icons/mail-accent.svg'
import telegramIcon from '@/assets/icons/telegram-accent-borderless.svg'
import telegramAccentIcon from '@/assets/icons/telegram-accent.svg'

interface Props {
    userType?: 'tourist' | 'agent'
}

const { userType = 'tourist' } = Astro.props
---

<section class="contact-form-section" class:list={{ '_agent': userType === 'agent' }}>
    {userType === 'tourist' ? (
        <div class="contact-form-container">
            <div class="contact-left">
                <h2 class="contact-title">Открываем мир</h2>

                <div class="contact-info">
                <div class="contact-item">
                    <span class="contact-label">Телефон</span>
                    <div class="contact-separator"></div>
                    <div class="social-icons">
                        <a href="#" class="social-icon" aria-label="Telegram">
                            <img src={telegramAccentIcon.src} alt="" />
                        </a>
                    </div>
                    <a href="tel:880020006578" class="contact-value">8 800 2000 6578</a>
                </div>

                <div class="contact-item">
                    <span class="contact-label">Email</span>
                    <div class="contact-separator"></div>
                    <a href="mailto:info@globus-tour.ru" class="contact-value">info@globus-tour.ru</a>
                </div>
            </div>

            <form class="newsletter-form">
                <input
                    type="email"
                    id="newsletter-email"
                    name="email"
                    placeholder="Подпишись на новости"
                    class="newsletter-input"
                    aria-label="Email для подписки"
                    autocomplete="email"
                />
                <button type="submit" class="newsletter-btn" aria-label="Подписаться">
                    <svg
                        width="39"
                        height="32"
                        viewBox="0 0 39 32"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            d="M37.5 16L1.5 16M37.5 16L22.5 31M37.5 16L22.5 1"
                            stroke="white"
                            stroke-width="2"></path>
                    </svg>
                </button>
            </form>
        </div>

        <div class="contact-right">
            <form class="contact-form">
                <h3 class="form-title">Напишите прямо сейчас</h3>

                <div class="form-group">
                    <label for="contact-name" class="form-label">Имя</label>
                    <input
                        type="text"
                        id="contact-name"
                        name="name"
                        class="form-input"
                        autocomplete="name"
                    />
                </div>

                <div class="form-group">
                    <label for="contact-phone" class="form-label">Телефон</label>
                    <input
                        type="tel"
                        id="contact-phone"
                        name="phone"
                        class="form-input"
                        autocomplete="tel"
                    />
                </div>

                <div class="form-group">
                    <label for="contact-comment" class="form-label">Комментарий</label>
                    <input
                        type="text"
                        id="contact-comment"
                        name="comment"
                        class="form-input"
                        autocomplete="off"
                    />
                </div>

                <div class="form-checkbox">
                    <input type="checkbox" id="contact-agree" name="agree" required />
                    <label for="contact-agree">
                        Я принимаю условия Пользовательского соглашения и подтверждаю согласие на
                        обработку моих персональных данных.
                    </label>
                </div>

                <button type="submit" class="button _sized">Отправить</button>
            </form>
        </div>
    </div>
    ) : (
        <div class="contact-agent-container">
            <h2 class="contact-title">Открываем мир</h2>

            <div class="contact-agent-buttons">
                <a href="tel:880020006578" class="button _sized _outline">
                    <img src={phoneIcon.src} alt="" />
                    <span>8 800 2000 6578</span>
                </a>

                <a href="mailto:info@globus-tour.ru" class="button _sized _outline">
                    <img src={mailIcon.src} alt="" />
                    <span>info@globus-tour.ru</span>
                </a>

                <a href="#" class="button _sized _outline">
                    <img src={telegramIcon.src} alt="" />
                    <span>Группа в ТГ</span>
                </a>

                <form class="newsletter-form">
                    <input
                        type="email"
                        id="newsletter-email-agent"
                        name="email"
                        placeholder="Подпишись на новости"
                        class="newsletter-input"
                        aria-label="Email для подписки"
                        autocomplete="email"
                    />
                    <button type="submit" class="newsletter-btn" aria-label="Подписаться">
                        <svg
                            width="39"
                            height="32"
                            viewBox="0 0 39 32"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M37.5 16L1.5 16M37.5 16L22.5 31M37.5 16L22.5 1"
                                stroke="white"
                                stroke-width="2"></path>
                        </svg>
                    </button>
                </form>
            </div>
        </div>
    )}
</section>

<style lang="scss" is:global>
    .contact-form-section {
        background: $color-globus-blue;
        @include adaptive(margin-top, 120, 60);
        @include adaptive(padding-top, 98, 60);
        @include adaptive(padding-bottom, 98, 60);
        @include side-paddings;

        .contact-form-container {
            position: relative;
            width: 100%;
            display: flex;
            @include adaptive(gap, 16, 60);

            > * {
                flex: 1;
            }

            @include mobile {
                flex-direction: column;
            }
        }

        .contact-left {
            display: flex;
            flex-direction: column;
            @include adaptive(gap, 93, 32);
        }

        .contact-title {
            color: $color-globus-cream;
            @include adaptive(text-align, left, center);
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            @include adaptive(gap, 36, 20);
        }

        .contact-item {
            @include flex-center-start;
            @include adaptive(gap, 36, 14);
            @include adaptive(width, 74%, 100%);

            @include mobile {
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        .contact-label {
            @include font-circe-regular;
            @include adaptive(font-size, 16, 18);
            line-height: 1.6;
            color: $color-main;
            text-transform: uppercase;
            @include adaptive(letter-spacing, 3.2, 3.2);
            opacity: 0.4;

            @include mobile {
                width: 100%;
                text-align: center;
            }
        }

        .contact-separator {
            height: 1px;
            flex: 1;
            background: $color-globus-sand;

            @include mobile {
                display: none;
            }
        }

        .contact-value {
            @include font-kudry-sans;
            @include adaptive(font-size, 28, 26);
            font-weight: 300;
            line-height: 1.2;
            color: $color-globus-cream;
            text-transform: uppercase;
            text-decoration: none;
            transition: opacity 0.3s;

            &:hover {
                opacity: 0.8;
            }
        }

        .social-icons {
            display: flex;
            @include adaptive(gap, 14, 12);
            align-items: center;
        }

        .social-icon {
            @include adaptive(width, 40, 45);
            @include adaptive(height, 40, 45);
            display: block;
            transition: transform 0.3s;

            img {
                width: 100%;
                height: 100%;
                object-fit: contain;
            }

            &:hover {
                transform: scale(1.1);
            }
        }

        .newsletter-form {
            position: relative;
            display: flex;
            align-items: center;
            @include adaptive(width, 500, 100%);
            @include adaptive(height, 60, 64);
            border-style: solid;
            border-color: $color-globus-sand;
            @include adaptive(border-width, 2, 2);
            border-right: none;
            border-radius: 500px;
            // overflow: hidden;
        }

        .newsletter-input {
            flex: 1;
            height: 100%;
            background: transparent;
            border: none;
            @include adaptive(padding-left, 45, 24);
            @include adaptive(padding-right, 20, 16);
            @include font-circe-regular;
            @include adaptive(font-size, 16, 18);
            line-height: 1.6;
            color: $color-globus-cream;
            text-transform: uppercase;
            @include adaptive(letter-spacing, 3.2, 3.2);
            outline: none;

            &::placeholder {
                color: $color-globus-grey;
            }
        }

        .newsletter-btn {
            @include adaptive(width, 60, 64);
            @include adaptive(height, 60, 64);
            background: $color-globus-sand;
            border: 1px solid $color-globus-sand;
            border-radius: 50%;
            @include flex-center;
            cursor: pointer;
            transition: all 0.3s;
            flex-shrink: 0;

            svg {
                @include adaptive(width, 39, 30);
                @include adaptive(height, 32, 24);
            }

            &:hover {
                // opacity: 0.8;
                transform: scale(1.05);
            }

            &:active {
                transform: scale(0.95);
            }
        }

        .contact-right {
            display: flex;
            align-items: flex-start;

            @include mobile {
                order: 1;
            }
        }

        .contact-form {
            width: 100%;
            display: flex;
            flex-direction: column;
        }

        .form-title {
            @include font-kudry-sans;
            @include adaptive(font-size, 28, 26);
            font-weight: 300;
            line-height: 1.2;
            color: $color-globus-cream;
            text-transform: uppercase;
            opacity: 0.4;
            margin: 0;

            @include mobile {
                text-align: center;
            }
        }

        .form-group {
            position: relative;
            display: flex;
            flex-direction: column;
            @include adaptive(margin-top, 32, 32);
        }

        .form-label {
            @include font-circe-regular;
            @include adaptive(font-size, 16, 18);
            line-height: 1.6;
            color: $color-globus-cream;
            text-transform: uppercase;
            @include adaptive(letter-spacing, 3.2, 3.2);
            opacity: 0.4;
        }

        .form-input {
            background: transparent;
            border: none;
            border-bottom: 1px solid rgba($color-globus-sand, 0.5);
            @include font-kudry-sans;
            @include adaptive(font-size, 20, 16);
            font-weight: 300;
            line-height: 1.2;
            color: $color-globus-cream;
            outline: none;
            transition: border-color 0.3s;

            &::placeholder {
                color: $color-globus-grey;
            }

            &:focus {
                border-bottom-color: $color-globus-sand;
            }
        }

        .form-checkbox {
            display: flex;
            @include adaptive(gap, 16, 16);
            align-items: flex-start;
            @include adaptive(margin-top, 16, 16);

            input[type='checkbox'] {
                @include adaptive(width, 15, 15);
                @include adaptive(height, 15, 15);
                flex-shrink: 0;
                appearance: none;
                border: 1px solid $color-globus-sand;
                @include adaptive(border-radius, 4, 4);
                cursor: pointer;
                transition: all 0.3s;
                margin: 0;

                &:checked {
                    background: $color-globus-sand;
                    border-color: $color-globus-sand;
                }

                &:hover {
                    opacity: 0.8;
                }
            }

            label {
                @include font-circe-regular;
                @include adaptive(font-size, 16, 20);
                line-height: 1;
                color: $color-globus-cream;
                opacity: 0.4;
                cursor: pointer;
                @include adaptive(letter-spacing, -0.32, -0.32);
            }
        }

        &:not(._agent) .button {
            @include adaptive(margin-top, 32, 32);
            @include adaptive(width, 200, 100%);
            align-self: flex-start;
        }
    }

    // Стили для версии агента
    .contact-form-section._agent {
        .contact-agent-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            @include adaptive(gap, 58, 50);
        }

        .contact-title {
            color: $color-globus-cream;
        }

        .contact-agent-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            @include adaptive(gap, 40, 28);
            width: 100%;

            @include mobile {
                flex-direction: column;
                align-items: stretch;
            }
        }

        .button {
            @include adaptive(font-size, 24, 18);
        }

        .newsletter-form {
            @include adaptive(width, 416, auto);
        }
    }
</style>
