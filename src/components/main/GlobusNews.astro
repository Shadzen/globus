---
// src/components/main/GlobusNews.astro
import { Image } from 'astro:assets'
import type { ImageMetadata } from 'astro'
import newsBig1 from '@/assets/images/news/main-news-big-1.jpg'
import newsBig2 from '@/assets/images/news/main-news-big-2.jpg'
import newsBig3 from '@/assets/images/news/main-news-big-3.jpg'
import newsSmall1 from '@/assets/images/news/main-news-small-1.jpg'
import newsSmall2 from '@/assets/images/news/main-news-small-2.jpg'
import newsSmall3 from '@/assets/images/news/main-news-small-3.jpg'
import newsSmall4 from '@/assets/images/news/main-news-small-4.jpg'
import SwiperNavButtons from '@/components/common/SwiperNavButtons.astro'

interface Props {
    userType?: 'tourist' | 'agent'
}

interface NewsCard {
    id: number
    title: string
    category: string
    image: ImageMetadata
}

const topCards: NewsCard[] = [
    {
        id: 1,
        title: 'Саудовская Аравия: Туры <br> на прямых рейсах из Москвы',
        category: 'Туры',
        image: newsBig1,
    },
    {
        id: 2,
        title: 'Турция приглашает <br> на бархатный сезон!',
        category: 'Страны',
        image: newsBig2,
    },
    {
        id: 3,
        title: 'Новый Год в Дубае – Концерт <br> легендарной группы Maroon 5!',
        category: 'Концерты',
        image: newsBig3,
    },
]

const bottomCards: NewsCard[] = [
    {
        id: 4,
        title: 'Авторские туры <br> в составе мини-группы',
        category: 'Туры',
        image: newsSmall1,
    },
    {
        id: 5,
        title: 'Вьетнам: <br> Топ-5 отелей Нячанга <br> на «Все включено»',
        category: 'Отели',
        image: newsSmall2,
    },
    {
        id: 6,
        title: 'Турция: Открыт новый отель Regnum The <br> Crown 5*!',
        category: 'Отели',
        image: newsSmall3,
    },
    {
        id: 7,
        title: 'Madinat Jumeirah - курорт для тех, кто выбирает только лучшее.',
        category: 'Страны',
        image: newsSmall4,
    },
    {
        id: 8,
        title: 'Авторские туры <br> в составе мини-группы',
        category: 'Туры',
        image: newsSmall1,
    },
    {
        id: 9,
        title: 'Вьетнам: <br> Топ-5 отелей Нячанга <br> на «Все включено»',
        category: 'Отели',
        image: newsSmall2,
    },
]

const { userType = 'tourist' } = Astro.props
const base = import.meta.env.BASE_URL
---

<section class="globus-news">
    <div class="section-container">
        <h2 class="news-title">Глобус-News</h2>

        <div class="news-top-grid">
            {
                topCards.map((card) => (
                    <a href="#" class="news-card news-card-top">
                        <span class="card-image">
                            <Image src={card.image} alt={card.title} loading="lazy" quality={100} />
                        </span>
                        <span class="card-content">
                            <span class="card-category">{card.category}</span>
                            <h3 class="card-title" set:html={card.title} />
                        </span>
                    </a>
                ))
            }
        </div>

        <div class="news-dark-section">
            <div class="news-dark-background">
                <SwiperNavButtons containerClass="news-nav" />
            </div>

            <div class="news-bottom-grid-wrapper swiper">
                <div class="news-bottom-grid swiper-wrapper">
                    {
                        bottomCards.map((card) => (
                            <a href="#" class="news-card news-card-bottom swiper-slide">
                                <span class="card-image">
                                    <Image
                                        src={card.image}
                                        alt={card.title}
                                        loading="lazy"
                                        quality={100}
                                    />
                                </span>
                                <span class="card-content">
                                    <span class="card-category">{card.category}</span>
                                    <h3 class="card-title" set:html={card.title} />
                                </span>
                            </a>
                        ))
                    }
                </div>
            </div>
        </div>

        <div class="news-button-wrapper">
            <a href={`${base}${userType}/news`} class="button _sized">Открыть глобус-news</a>
        </div>
    </div>
</section>

<style lang="scss" is:global>
    .globus-news {
        @include adaptive(margin-top, 120, 60);

        .section-container {
            @include flex-center;
            flex-direction: column;
            @include adaptive(gap, 72, 40);
            padding: 0;
        }

        .news-top-grid {
            @include side-paddings;
            position: relative;
            width: 100%;
            display: flex;
            @include adaptive(column-gap, 84, 15);
            flex-wrap: wrap;
            align-items: flex-start;
            z-index: 10;

            @include mobile {
                flex-direction: column;
                column-gap: 0;
                @include adaptive(row-gap, 50, 50);
            }
        }

        .news-card {
            position: relative;
            display: flex;
            flex-direction: column;
            cursor: pointer;
            white-space: normal;
            flex-shrink: 0;
            @include hover-card-default;
        }

        .news-card-top {
            @include adaptive(gap, 22, 22);

            .card-content {
                @include adaptive(gap, 14, 20);
            }

            &:nth-child(1) {
                @include adaptive(width, 54%, 100%);
            }
            &:nth-child(2) {
                @include adaptive(width, 41.11%, 100%);
                @include adaptive(margin-top, 80, 0);
            }
            &:nth-child(3) {
                @include adaptive(width, 38.1%, 100%);
                @include adaptive(margin-top, -48, 0);
                @include adaptive(margin-left, 274, 0);

                .card-category {
                    color: $color-main;
                }

                .card-title {
                    color: $color-main;
                }
            }
        }

        .news-card-bottom {
            @include adaptive(gap, 22, 20);
            @include adaptive(max-width, 418, 351);

            .card-content {
                @include adaptive(gap, 22, 20);
            }
        }

        .card-image {
            position: relative;
            width: 100%;
            @include adaptive(height, auto, 231);
            overflow: hidden;

            img {
                display: block;
                width: 100%;
                height: 100%;
                object-fit: cover;
                object-position: center;
            }
        }

        .card-content {
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .card-category {
            @include font-circe-regular;
            @include adaptive(font-size, 16, 18);
            line-height: 1.6;
            color: $color-globus-light-blue;
            text-transform: uppercase;
            @include adaptive(letter-spacing, 3.2, 2);
            font-weight: 400;
        }

        .card-title {
            @include adaptive(font-size, 28, 26);
            color: $color-globus-blue;
        }

        .news-dark-section {
            position: relative;
            width: 100%;
            @include adaptive(margin-top, -376, -250);
            overflow: hidden;
        }

        .news-dark-background {
            position: relative;
            width: 100%;
            @include adaptive(height, 630, 470);
            background: $color-globus-blue;
            @include side-paddings;
            @include flex-center-end;
        }

        .news-bottom-grid-wrapper {
            position: relative;
            width: 100%;
            overflow: hidden;
            z-index: 10;
            @include adaptive(padding-top, 20, 10);
            @include adaptive(margin-top, -238, -210);
        }

        .news-bottom-grid {
            position: relative;
            width: 100%;
            display: flex;
        }

        .news-button-wrapper {
            position: relative;
            width: 100%;
            @include flex-center;
            @include side-paddings;
        }

        .button {
            @include adaptive(width, 350, 100%);
        }
    }
</style>
