---
import arrowIcon from '@/assets/icons/arrow-14-accent.svg'

interface InclusionItem {
    text: string
}

interface AdditionalContent {
    type: 'link' | 'text' | 'list'
    data: {
        link?: { href: string; text: string }
        text?: string
        items?: InclusionItem[]
    }
}

interface Props {
    includedItems: InclusionItem[][]
    additionalContent?: AdditionalContent[]
    useGrid?: boolean
    darkTheme?: boolean
}

const { includedItems, additionalContent = [], useGrid = false, darkTheme = false } = Astro.props
---

<section class:list={['tour-inclusions-section', { 'dark-theme': darkTheme }]}>
    <div class="section-container">
        <h2 class="section-title">В стоимость тура входит:</h2>

        {useGrid ? (
            <ul class="inclusions-grid">
                {includedItems.flat().map((item) => (
                    <li class="inclusion-item">
                        <div class="inclusion-bullet"></div>
                        <p class="inclusion-text">{item.text}</p>
                    </li>
                ))}
            </ul>
        ) : (
            <div class="info-columns">
                {includedItems.map((column) => (
                    <ul class="info-list">
                        {column.map((item) => (
                            <li class="info-item">
                                <span class="bullet"></span>
                                <p class="info-text">{item.text}</p>
                            </li>
                        ))}
                    </ul>
                ))}
            </div>
        )}

        <div class="divider"></div>

        <h3 class="subsection-title">Дополнительно оплачивается:</h3>

        {additionalContent.length > 0 && (
            <div class="additional-section">
                {additionalContent.map((content) => (
                    <>
                        {content.type === 'link' && content.data.link && (
                            <a href="#" class="additional-link">
                                <span class="svg-icon">
                                    <img src={arrowIcon.src} alt="" />
                                </span>
                                <span class="additional-text">Виза в Садовскую Аравию</span>
                            </a>
                        )}
                        {content.type === 'text' && content.data.text && (
                            <p class="additional-text" set:html={content.data.text}></p>
                        )}
                        {content.type === 'list' && content.data.items && (
                            <ul class:list={[useGrid ? 'inclusions-grid' : 'info-columns']}>
                                {content.data.items.map((item) => (
                                    <li class:list={[useGrid ? 'inclusion-item' : 'info-item']}>
                                        {useGrid ? (
                                            <div class="bullet"></div>
                                        ) : (
                                            <span class="bullet"></span>
                                        )}
                                        <p class:list={[useGrid ? 'inclusion-text' : 'info-text']}>{item.text}</p>
                                    </li>
                                ))}
                            </ul>
                        )}
                    </>
                ))}
            </div>
        )}

        <div class="divider"></div>

        <div class="bottom-section">
            <p class="bottom-text">
                Если вы не нашли подходящий вариант тура в нашем поиске, вы можете отправить запрос на электронную почту.
            </p>
            <div class="bottom-buttons">
                <button class="button _sized _outline" type="button">
                    запрос на поиск
                </button>
                <button class="button _sized" type="button">
                    перейти в поиск туров
                </button>
            </div>
        </div>
    </div>
</section>

<style lang="scss" is:global>
    .tour-inclusions-section {
        @include adaptive(padding-top, 80, 50);
        @include adaptive(padding-bottom, 80, 50);

        &.dark-theme {
            background: $color-globus-blue;

            .section-title,
            .subsection-title,
            .info-text,
            .inclusion-text,
            .bottom-text {
                color: $color-globus-cream;
            }

            .additional-text {
                color: $color-globus-cream;
            }
        }

        .section-title {
            @include adaptive(margin-bottom, 50, 30);
        }

        // Grid layout (для NewsTypeFour)
        .inclusions-grid {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            @include adaptive(gap, 30, 20);

            @include mobile {
                grid-template-columns: 1fr;
            }
        }

        .inclusion-item {
            display: flex;
            @include adaptive(gap, 10, 8);
            align-items: flex-start;

            .bullet {
                @include adaptive(margin-top, 6, 5);
            }
        }

        .inclusion-text {
            @include font-circe-regular;
            color: $color-globus-blue;
            @include adaptive(font-size, 20, 18);
            line-height: 1.2;
            margin: 0;
        }

        // Columns layout (для NewsTypeOne)
        .info-columns {
            display: flex;
            @include adaptive(gap, 55, 20);

            @include mobile {
                flex-direction: column;
            }
        }

        .info-list {
            flex: 1;
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            @include adaptive(gap, 30, 20);
        }

        .info-item {
            display: flex;
            @include adaptive(gap, 10, 8);
            align-items: flex-start;

            .bullet {
                @include adaptive(margin-top, 8, 6);
            }
        }

        .info-text {
            @include font-circe-regular;
            color: $color-globus-blue;
            @include adaptive(font-size, 20, 16);
            line-height: 1.2;
            margin: 0;
            flex: 1;
        }

        .divider {
            @include adaptive(margin-top, 50, 30);
            @include adaptive(margin-bottom, 40, 25);
        }

        .subsection-title {
            color: $color-alternate;
            @include adaptive(font-size, 32, 24);
            text-align: center;
            @include adaptive(margin-bottom, 40, 25);
        }

        .additional-section {
            display: flex;
            @include adaptive(gap, 260, 20);

            @include mobile {
                flex-direction: column;
            }
        }

        .additional-link {
            display: flex;
            align-items: center;
            transition: opacity 0.3s ease;

            .additional-text {
                text-decoration: underline;
            }

            &:hover {
                opacity: 0.8;
            }
        }

        .additional-text {
            @include font-circe-regular;
            color: $color-globus-blue;
            @include adaptive(font-size, 26, 18);
            line-height: 1.2;
            margin: 0;
        }

        .bottom-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            @include adaptive(gap, 30, 20);

            @include mobile {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        .bottom-text {
            @include font-circe-light;
            color: $color-globus-blue;
            @include adaptive(font-size, 26, 18);
            line-height: 1.2;
            margin: 0;
            flex: 1;
            max-width: 693px;
        }

        .bottom-buttons {
            display: flex;
            @include adaptive(gap, 20, 20);
            flex-shrink: 0;

            @include mobile {
                width: 100%;
                flex-direction: column;
            }
        }
    }
</style>
